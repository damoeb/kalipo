<div ng-controller="ThreadController">

    <div class="col-lg-7 col-md-9 col-xs-9">


        <div class="panel panel-default">

            <div class="panel-body">

                <div ng-if="thread.link">
                    <h4 style="display: inline;">
                        <a href="{{ ::thread.link}}">{{ ::thread.title}}</a>
                    </h4>
                    [{{ ::thread.domain}}]
                </div>
                <div ng-if="!thread.link">
                    <h4>
                        {{ ::thread.title}}
                    </h4>
                </div>

                <p>
                    submitted {{ thread.createdDate | fromNow}} by {{::thread.displayName}}
                    <span ng-if="authenticated">
                        [<a href="#/comments/{{$threadId}}/edit">Edit</a>]
                    </span>
                </p>

                <div ng-if="thread.bodyHtml">
                    {{::thread.bodyHtml}}
                </div>

            </div>

        </div>

        <div ng-include="'views/modal_reply.html'"></div>
        <div ng-include="'views/modal_report.html'"></div>

        <div class="alert alert-danger" ng-if="thread.status == 'LOCKED'">
            This discussion is <strong>temporarily locked</strong>. Currently, you cannot post new comments.
        </div>
        <div class="alert alert-danger" ng-if="thread.status == 'CLOSED'">
            This discussion is <strong>closed</strong>.
        </div>

        <div class="panel panel-default">
            <div class="panel-body">

                <div ng-include="'create_comment.template'"></div>

                <div when-scrolled="loadMore()">
                    <div ng-repeat="page in pages">

                        <discussion></discussion>

                    </div>

                    <div class="text-center" ng-show="$busy">
                        <i class="glyphicon glyphicon-refresh spinning"></i>
                    </div>

                </div>

                <div ng-show="$isEmptyDiscussion">
                    <div class="alert alert-success" role="alert">
                        You may start on a green lawn!
                    </div>

                </div>

                <button class="btn btn-primary" ng-click="loadMore()" ng-hide="$busy || $isLastPage"
                        style="width: 100%">Show More
                </button>

                <div ng-show="!$isEmptyDiscussion && $isLastPage" class="text-center" style="font-size: large">
                    &diams;
                </div>
            </div>
        </div>
    </div>


    <div class="col-lg-5 col-md-3 col-xs-3">
        <div
            style="position: fixed; width: 5px; background-color: black; height: 100px; top:0; margin-left: -10px; display: none"
            id="outline-viewport-indicator" title="your viewport, the comments you see"></div>
        <div style="overflow-y: auto; overflow-x: hidden; position: relative">
            <thread-outline pages="pages"></thread-outline>
        </div>
    </div>


</div>



<script type="text/ng-template" id="create_comment.template">
    <div style="padding-top: 10px;" class="clearfix">
        <textarea class="form-control field-comment" placeholder="Have Something To Say?" rows="1"
                  ng-focus="showReplyModal('')"></textarea>
    </div>
</script>
